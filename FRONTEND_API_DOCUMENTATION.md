# EduNexus Frontend API Documentation

## Overview

This document provides comprehensive documentation for the EduNexus frontend application. It details how the frontend integrates with backend APIs, manages authentication, maintains state, and handles user interactions.

**Version:** 1.0.1  
**Last Updated:** December 12, 2025  
**Status:** ✅ Production Ready  
**Framework:** React 19 + Vite  
**State Management:** Context API  
**UI Library:** Material-UI (MUI)  
**Testing:** Vitest 4.0.15 + Cypress E2E Tests  

---

## Table of Contents

1. [Base URLs & Environment Configuration](#base-urls--environment-configuration)
2. [Authentication Flow](#authentication-flow)
3. [State Management](#state-management)
4. [API Integration](#api-integration)
5. [Components & Routes](#components--routes)
6. [Helpers & Utilities](#helpers--utilities)
7. [UI/UX Flows](#uiux-flows)
8. [Error Handling](#error-handling)
9. [Implementation Checklist](#implementation-checklist)
10. [Known Limitations](#known-limitations)
11. [Next Steps](#next-steps)

---

## Base URLs & Environment Configuration

### Development Environment

```
API Base URL: http://localhost:3000/api
Frontend URL: http://localhost:5173
```

### Production Environment

```
API Base URL: https://your-render-url/api
Frontend URL: https://comp229-portfolio-frontend.vercel.app
```

### Configuration

Create a `.env` file in the project root to override the API URL:

```env
# .env (development)
VITE_API_BASE_URL=http://localhost:3000/api

# .env.production
VITE_API_BASE_URL=https://your-render-url/api
```

The API base URL is configured in `src/components/auth/auth-helper.js`:

```javascript
const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || "http://localhost:3000/api";
```

---

## Authentication Flow

### Overview

The authentication system uses JWT (JSON Web Token) for secure, stateless authentication. Tokens are stored in `localStorage` and persisted across page refreshes.

```
User → Sign Up/Sign In → Backend validates credentials → Returns JWT token → Store in localStorage → Attach to future requests
```

### 1. Sign Up (User Registration)

**Endpoint:** `POST /auth/signup`

**Request Body:**
```json
{
  "uid": "john_doe_123",
  "displayName": "John Doe",
  "email": "john@example.com",
  "password": "securePassword123",
  "role": "student"
}
```

**Note:** `uid` is optional. If not provided, the backend will auto-generate it.

**Response (Success):**
```json
{
  "success": true,
  "message": "User created successfully",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "uid": "john_doe_123",
    "displayName": "John Doe",
    "email": "john@example.com",
    "role": "student"
  }
}
```

**Response (Error - User Already Exists):**
```json
{
  "success": false,
  "message": "User with this uid or email already exists"
}
```

**Frontend Flow:**
1. User navigates to `/users/signup`
2. Fills form: Full Name, Email, Role (optional), Password, Confirm Password
3. Note: User ID field removed - auto-generated by backend
4. Frontend validates:
   - Full name required
   - Email required and valid format
   - Password ≥ 6 characters
   - Passwords match
5. Calls `signup()` from `AuthContext`
   - Generates a temporary uid if needed (backend will override with proper one)
6. On success:
   - **Token stored in localStorage** (key: `'token'`)
   - **User object stored in localStorage** (key: `'user'`)
   - Redirects to home page (`/`)
   - User is logged in globally via Context
7. On error:
   - Displays error message (e.g., "User with this uid or email already exists")
   - User remains on signup page

**File:** `src/components/auth/Signup.jsx`

---

### 2. Sign In (User Authentication)

**Endpoint:** `POST /auth/signin`

**Request Body:**
```json
{
  "email": "john@example.com",
  "password": "securePassword123"
}
```

**Response (Success):**
```json
{
  "success": true,
  "message": "User authenticated successfully",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "uid": "john_doe_123",
    "displayName": "John Doe",
    "email": "john@example.com",
    "role": "student"
  }
}
```

**Response (Error - Invalid Credentials):**
```json
{
  "success": false,
  "message": "Invalid email or password"
}
```

**Frontend Flow:**
1. User navigates to `/users/signin`
2. Fills form: Email, Password
3. Frontend validates:
   - Email required
   - Password required
4. Calls `signin()` from `AuthContext`
5. On success:
   - **Token stored in localStorage** (key: `'token'`)
   - **User object stored in localStorage** (key: `'user'`)
   - Redirects to:
     - Previously requested page (if came from protected route)
     - Home page (default)
   - User is authenticated globally
6. On error:
   - Displays error message
   - User remains on signin page

**File:** `src/components/auth/Signin.jsx`

---

### 3. Token Storage & Management

**Storage Location:** Browser `localStorage`

**Keys & Values:**

```javascript
// Key: 'token'
// Value: JWT string
localStorage.setItem('token', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...');

// Key: 'user'
// Value: User object (JSON stringified)
localStorage.setItem('user', JSON.stringify({
  uid: "john_doe_123",
  displayName: "John Doe",
  email: "john@example.com",
  role: "student"
}));
```

**Verification in Browser DevTools:**
```
Application → Local Storage → http://localhost:5173
├── token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
└── user: {"uid":"john_doe_123","displayName":"John Doe","email":"john@example.com","role":"student"}
```

**Token Format:**
```
Authorization: Bearer <token>
Header: "Authorization"
Value: "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

**Token Expiration:**
- Backend: 7 days
- Frontend checks expiration on app load and when making requests
- Expired tokens trigger automatic logout and redirect to `/users/signin`

**Storage Helper Functions:**

```javascript
// src/components/auth/auth-helper.js

// Store token
setToken(token) 
  → localStorage.setItem('token', token)

// Retrieve token
getToken() 
  → localStorage.getItem('token')

// Remove token
removeToken() 
  → localStorage.removeItem('token')
  → localStorage.removeItem('user')

// Check if authenticated
isAuthenticated() 
  → Checks if token exists AND not expired

// Store user data
setUser(user) 
  → localStorage.setItem('user', JSON.stringify(user))

// Retrieve user data
getUser() 
  → JSON.parse(localStorage.getItem('user'))
```

---

### 4. Logout

**Frontend Flow:**
1. User clicks "Sign Out" in navbar dropdown
2. Calls `logout()` from `AuthContext`
3. Token removed from localStorage
4. User data removed from localStorage
5. Global auth state updated (`isAuth = false`, `user = null`)
6. Redirects to home page (`/`)
7. Navigation UI updates (shows Sign In/Sign Up buttons)

**File:** `src/components/Layout.jsx`

---

### 5. Token Expiration Handling

**Automatic Detection:**
1. Token validated on app mount in `AuthContext`
2. Token validated before each authenticated request via `authenticatedFetch()`
3. JWT decoded to check `exp` claim against current time

**Auto-Logout on Expiration:**
```javascript
// If token has expired:
if (decoded.exp <= currentTime) {
  logout()  // Clear token and user
  redirect('/users/signin')
}
```

**User Experience:**
- Silent logout (no disruption)
- User redirected to signin with friendly message
- User can sign in again immediately

---

## State Management

### Context API Architecture

The application uses **React Context API** for global authentication state management, avoiding prop drilling and ensuring auth state is accessible throughout the app.

### AuthContext Structure

**File:** `src/components/auth/AuthContext.jsx`

**Context Provider:**
```javascript
<AuthProvider>
  <App /> {/* All child components have access to auth state */}
</AuthProvider>
```

**Global State:**
```javascript
{
  user: {
    displayName: "John Doe",
    email: "john@example.com",
    role: "student"
  },
  isAuth: true,
  loading: false,
  error: null,
  
  // Methods
  signup(uid, displayName, email, password, role),
  signin(email, password),
  logout()
}
```

### Accessing Auth State

**Hook:** `useAuth()`

```javascript
import { useAuth } from '../auth/AuthContext';

function MyComponent() {
  const { user, isAuth, loading, error, signup, signin, logout } = useAuth();
  
  if (loading) return <CircularProgress />;
  
  if (isAuth) {
    return <div>Welcome, {user.displayName}!</div>;
  }
  
  return <div>Please sign in</div>;
}
```

### State Persistence

**On App Load:**
1. `AuthProvider` checks localStorage for token
2. Validates token expiration
3. Loads user data from localStorage
4. Sets global auth state accordingly
5. Child components render with correct auth state

**Across Page Refreshes:**
- Token persists in localStorage
- User data persists in localStorage
- Auth state restored on page reload
- No interruption in user session

---

## API Integration

### Service Layer Architecture

All API communication flows through service modules for clean separation of concerns.

```
Component → Service (coursesService.js) → authenticatedFetch() → Backend
```

### Courses Service

**File:** `src/services/coursesService.js`

**Public Endpoints:**

```javascript
// Get all courses (no auth required)
list() 
  → GET /courses
  → Returns: Array<Course>

// Get single course (no auth required)
read(id) 
  → GET /courses/:id
  → Returns: Course
```

**Protected Endpoints:**

```javascript
// Create course (auth required)
create(courseData) 
  → POST /courses
  → Headers: Authorization: Bearer <token>
  → Returns: Created Course object

// Update course (auth + ownership required)
update(id, courseData) 
  → PUT /courses/:id
  → Headers: Authorization: Bearer <token>
  → Returns: Updated Course object
  → Error 403: Not owner

// Delete course (auth + ownership required)
remove(id) 
  → DELETE /courses/:id
  → Headers: Authorization: Bearer <token>
  → Returns: { success: true }
  → Error 403: Not owner
```

**Example Usage:**
```javascript
import { list, create, read, update, remove } from '../../services/coursesService';

// List courses
const courses = await list();

// Create course (only for authenticated users)
const newCourse = await create({
  title: "React Fundamentals",
  description: "Learn React basics",
  credits: 3,
  status: "active",
  instructor: "Dr. Smith"
});

// Update course (only owner)
const updated = await update(courseId, { title: "Advanced React" });

// Delete course (only owner)
await remove(courseId);
```

---

### Users Service

**File:** `src/services/usersService.js`

**Public Endpoints:**

```javascript
// Get all users (no auth required)
list() 
  → GET /users
  → Returns: Array<User>

// Get single user (no auth required)
read(uid) 
  → GET /users/:uid
  → Returns: User
```

**Protected Endpoints:**

```javascript
// Update user (auth required)
update(uid, userData) 
  → PUT /users/:uid
  → Headers: Authorization: Bearer <token>
  → Returns: Updated User object

// Delete user (auth required)
remove(uid) 
  → DELETE /users/:uid
  → Headers: Authorization: Bearer <token>
  → Returns: { success: true }
```

---

### Projects Service

**File:** `src/services/projectsService.js`

**Public Endpoints:**

```javascript
// Get all projects (no auth required)
list() 
  → GET /projects
  → Returns: Array<Project>

// Get single project (no auth required)
read(id) 
  → GET /projects/:id
  → Returns: Project
```

**Protected Endpoints:**

```javascript
// Create project (auth required)
create(projectData) 
  → POST /projects
  → Headers: Authorization: Bearer <token>
  → Returns: Created Project object

// Update project (auth + ownership required)
update(id, projectData) 
  → PUT /projects/:id
  → Headers: Authorization: Bearer <token>
  → Returns: Updated Project object
  → Error 403: Not owner

// Delete project (auth + ownership required)
remove(id) 
  → DELETE /projects/:id
  → Headers: Authorization: Bearer <token>
  → Returns: { success: true }
  → Error 403: Not owner
```

**Example Usage:**
```javascript
import { list, create, read, update, remove } from '../../services/projectsService';

// List projects
const projects = await list();

// Create project (only for authenticated users)
const newProject = await create({
  title: "E-Commerce Platform",
  description: "Full-stack e-commerce application",
  category: "Full Stack",
  startDate: "2025-01-01",
  endDate: "2025-03-01",
  github: "https://github.com/user/ecommerce"
});

// Update project (only owner)
const updated = await update(projectId, { title: "Advanced E-Commerce" });

// Delete project (only owner)
await remove(projectId);
```

---

### Feedback Service

**File:** `src/services/feedbackService.js`

**Public Endpoints:**

```javascript
// Get feedback for a project (no auth required)
listForProject(projectId) 
  → GET /feedback?projectId=<projectId>
  → Returns: Array<Feedback>
```

**Protected Endpoints:**

```javascript
// Create feedback (auth required)
create(feedbackData) 
  → POST /feedback
  → Headers: Authorization: Bearer <token>
  → Body: { projectId, rating, comment, author: userId }
  → Returns: Created Feedback object

// Update feedback (auth + author required)
update(id, feedbackData) 
  → PUT /feedback/:id
  → Headers: Authorization: Bearer <token>
  → Returns: Updated Feedback object
  → Error 403: Not author

// Delete feedback (auth + author required)
remove(id) 
  → DELETE /feedback/:id
  → Headers: Authorization: Bearer <token>
  → Returns: { success: true }
  → Error 403: Not author
```

**Example Usage:**
```javascript
import { listForProject, create, update, remove } from '../../services/feedbackService';

// Get feedback for a project
const feedback = await listForProject(projectId);

// Create feedback (only for authenticated users)
const newFeedback = await create({
  projectId: "project_123",
  rating: 5,
  comment: "Excellent work on this project!"
});

// Update feedback (only author)
const updated = await update(feedbackId, { rating: 4, comment: "Good work" });

// Delete feedback (only author)
await remove(feedbackId);
```

---

### Dashboard Service

**File:** `src/services/dashboardService.js` (implied in API calls)

**Protected Endpoints:**

```javascript
// Get user dashboard data (auth required)
getDashboard() 
  → GET /dashboard/me
  → Headers: Authorization: Bearer <token>
  → Returns: {
      user: User,
      courses: Array<Course>,
      projects: Array<Project>,
      feedback: Array<Feedback>
    }
```

**Example Usage:**
```javascript
// Typically called in Dashboard.jsx
const response = await authenticatedFetch(`${API_BASE_URL}/dashboard/me`, {
  headers: { 'Cache-Control': 'no-cache' }
});
const dashboardData = await response.json();
```

---

### Authenticated Fetch Wrapper

**File:** `src/components/auth/auth-helper.js`

**Purpose:** Automatically attach JWT token to all authenticated requests

**Function Signature:**
```javascript
authenticatedFetch(url, options = {})
  → Wrapper around fetch()
  → Automatically adds Authorization header
  → Handles token expiration
  → Returns: Response object
```

**How It Works:**
1. Retrieves token from localStorage
2. Creates headers object with `Authorization: Bearer <token>`
3. Merges with any custom headers from options
4. Makes fetch request
5. Checks for 401 (expired token) response
6. Auto-logout and redirect if token expired

**Example Usage:**
```javascript
// In service layer
const response = await authenticatedFetch(`/courses`, {
  method: 'POST',
  headers: {
    'Accept': 'application/json',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify(courseData)
});

const data = await response.json();
```

---

## Components & Routes

### Route Structure

```
/
├── / (Home)
├── /dashboard (Dashboard - Protected)
├── /users/signin (Sign In)
├── /users/signup (Sign Up)
├── /users/list (List Users - Public)
├── /users/edit/:uid (Edit User - Protected)
├── /course/list (List Courses - Public)
├── /course/add (Add Course - Protected)
├── /course/edit/:id (Edit Course - Protected)
├── /project/list (List Projects - Public)
├── /project/add (Add Project - Protected)
├── /project/edit/:id (Edit Project - Protected)
├── /project/:id (Project Details - Public)
└── * (Not Found)
```

### Component Descriptions

#### 1. Layout.jsx
**Location:** `src/components/Layout.jsx`

**Purpose:** Main navigation header and layout wrapper

**Key Features:**
- Navigation menu with links
- Auth state display
- User profile dropdown (when logged in)
- Logout button
- Responsive mobile menu

**Auth Integration:**
- Uses `useAuth()` hook
- Shows "Sign In/Sign Up" buttons for unauthenticated users
- Shows user displayName and role for authenticated users
- Logout clears token and redirects

**Used By:** All pages (via MainRouter)

---

#### 2. Signin.jsx
**Location:** `src/components/auth/Signin.jsx`

**Purpose:** User login form

**Form Fields:**
- Email (required, email format)
- Password (required, min 6 chars)

**Key Features:**
- Form validation
- Error display
- Loading state during signin
- Redirect to previous page after signin
- Link to signup page

**Auth Integration:**
- Calls `signin()` from `useAuth()`
- Stores token on success
- Handles authentication errors

**Route:** `/users/signin`

---

#### 3. Signup.jsx
**Location:** `src/components/auth/Signup.jsx`

**Purpose:** User registration form

**Form Fields:**
- Full Name (required)
- Email (required, email format)
- Role (required, dropdown: student/instructor/admin)
- Password (required, min 6 chars)
- Confirm Password (required, must match)

**Key Features:**
- Form validation
- Password matching validation
- Error display
- Loading state during signup
- Auto-generated user ID
- Redirect to home after signup
- Link to signin page

**Auth Integration:**
- Calls `signup()` from `useAuth()`
- Stores token on success
- Auto-login after signup

**Route:** `/users/signup`

---

#### 4. Home.jsx
**Location:** `src/components/Home.jsx`

**Purpose:** Landing page

**Key Features:**
- Application overview
- Links to main features
- Accessible to all users (authenticated and public)

**Route:** `/`

---

#### 5. ListCourse.jsx
**Location:** `src/components/Course/ListCourse.jsx`

**Purpose:** Display all courses in a table

**Key Features:**
- Fetch all courses (public endpoint)
- Display course details: Title, Instructor, Credits, Status
- "Add Course" button (only visible to authenticated users)
- Loading state while fetching
- Error handling and display
- Reload functionality

**Auth Integration:**
- Uses `useAuth()` to check if user is authenticated
- "Add Course" button conditionally visible
- Edit/Delete buttons visible only to authenticated users

**API Calls:**
```javascript
// Public endpoint
const courses = await list();
```

**Route:** `/course/list`

---

#### 6. ListItemCourse.jsx
**Location:** `src/components/Course/ListItemCourse.jsx`

**Purpose:** Individual course row in the course list

**Key Features:**
- Display single course details
- Edit button (link to edit page)
- Delete button with confirmation
- Auth-protected buttons

**Auth Integration:**
- Edit/Delete buttons only visible to authenticated users
- Delete calls `remove()` with auth header
- Error handling for 403 (not owner)

**Used By:** ListCourse.jsx (maps through courses)

---

#### 7. AddCourse.jsx
**Location:** `src/components/Course/AddCourse.jsx`

**Purpose:** Form to create new course

**Protection:** Auth Required ✅
- Redirects unauthenticated users to `/users/signin`
- Shows loading state while checking auth

**Key Features:**
- Course form (title, description, credits, status, instructor)
- Form validation
- Loading state during submission
- Error handling
- Redirect to course list on success

**Auth Integration:**
- `useAuth()` hook checks authentication
- Creates course via `create()` service with auth header
- Auto-logout on token expiration (401 response)

**API Call:**
```javascript
const newCourse = await create(courseData);
```

**Route:** `/course/add`

---

#### 8. EditICourse.jsx
**Location:** `src/components/Course/EditICourse.jsx`

**Purpose:** Form to edit existing course

**Protection:** Auth Required ✅
- Redirects unauthenticated users to `/users/signin`
- Backend validates ownership (403 if not owner)

**Key Features:**
- Load course data by ID
- Pre-populate form with existing data
- Edit course details
- Loading state while fetching and updating
- Error handling
- Redirect to course list on success

**Auth Integration:**
- `useAuth()` hook checks authentication
- Updates course via `update()` service with auth header
- Shows ownership error if applicable

**API Calls:**
```javascript
// Public endpoint
const courseData = await read(courseId);

// Protected endpoint
const updated = await update(courseId, newData);
```

**Route:** `/course/edit/:id`

---

#### 9. ListUser.jsx
**Location:** `src/components/User/ListUser.jsx`

**Purpose:** Display all users in a table

**Key Features:**
- Fetch all users (public endpoint)
- Display user details: Display Name, Email, Role, Bio
- Loading state while fetching
- Error handling and display
- Reload functionality

**API Calls:**
```javascript
// Public endpoint
const users = await list();
```

**Route:** `/users/list`

---

#### 10. ListItemUser.jsx
**Location:** `src/components/User/ListItemUser.jsx`

**Purpose:** Individual user row in the user list

**Key Features:**
- Display single user details
- Edit button (link to edit page, if own profile)
- Delete button (if own profile) with confirmation
- Auth-protected buttons

**Auth Integration:**
- Edit/Delete buttons only visible to authenticated users
- Only visible if editing own profile
- Delete calls `remove()` with auth header

**Used By:** ListUser.jsx (maps through users)

---

#### 11. EditUser.jsx
**Location:** `src/components/User/EditUser.jsx`

**Purpose:** Form to edit user profile

**Protection:** Auth Required ✅
- Redirects unauthenticated users to `/users/signin`
- Users can only edit their own profiles

**Key Features:**
- Load user data by UID
- Pre-populate form with existing data
- Edit display name and bio
- Email field removed for security
- Loading state while fetching and updating
- Error handling
- Redirect to home page on success

**Auth Integration:**
- `useAuth()` hook checks authentication
- Updates user via `update()` service with auth header
- Shows permission error if not own profile

**Route:** `/users/edit/:uid`

---

#### 12. ListProject.jsx
**Location:** `src/components/Project/ListProject.jsx`

**Purpose:** Display all projects in a list or grid

**Key Features:**
- Fetch all projects (public endpoint)
- Display project details: Title, Category, Description
- "Add Project" button (only visible to authenticated users)
- Loading state while fetching
- Error handling and display
- Reload functionality

**Auth Integration:**
- Uses `useAuth()` to check if user is authenticated
- "Add Project" button conditionally visible
- Edit/Delete buttons visible only to authenticated users

**API Calls:**
```javascript
// Public endpoint
const projects = await list();
```

**Route:** `/project/list`

---

#### 13. AddProject.jsx
**Location:** `src/components/Project/AddProject.jsx`

**Purpose:** Form to create new project

**Protection:** Auth Required ✅
- Redirects unauthenticated users to `/users/signin`
- Shows loading state while checking auth

**Key Features:**
- Project form (title, description, category, dates, github link)
- Form validation
- Loading state during submission
- Error handling
- Redirect to projects list on success

**Auth Integration:**
- `useAuth()` hook checks authentication
- Creates project via `create()` service with auth header
- Auto-logout on token expiration (401 response)

**API Call:**
```javascript
const newProject = await create(projectData);
```

**Route:** `/project/add`

---

#### 14. EditProject.jsx
**Location:** `src/components/Project/EditProject.jsx`

**Purpose:** Form to edit existing project

**Protection:** Auth Required ✅
- Redirects unauthenticated users to `/users/signin`
- Backend validates ownership (403 if not owner)

**Key Features:**
- Load project data by ID
- Pre-populate form with existing data
- Edit project details
- Loading state while fetching and updating
- Error handling
- Redirect to projects list on success

**Auth Integration:**
- `useAuth()` hook checks authentication
- Updates project via `update()` service with auth header
- Shows ownership error if applicable

**API Calls:**
```javascript
// Public endpoint
const projectData = await read(projectId);

// Protected endpoint
const updated = await update(projectId, newData);
```

**Route:** `/project/edit/:id`

---

#### 15. ProjectDetail.jsx
**Location:** `src/components/ProjectDetail.jsx`

**Purpose:** Display project details with feedback section

**Key Features:**
- Display project information: Title, Description, Category, Dates, GitHub link
- Show all feedback for the project
- Feedback form (for authenticated users)
- Leave feedback with 1-5 star rating
- Edit/Delete own feedback
- Responsive layout (feedback cards + form side-by-side on desktop)
- Loading and error states

**Auth Integration:**
- Feedback form visible only to authenticated users
- Edit/Delete feedback buttons visible only to feedback author
- `useAuth()` hook for current user info

**API Calls:**
```javascript
// Get project details (public)
const project = await read(projectId);

// Get feedback (public)
const feedback = await listForProject(projectId);

// Create/Update/Delete feedback (protected)
await create(feedbackData);
await update(feedbackId, updatedData);
await remove(feedbackId);
```

**Route:** `/project/:id`

---

#### 16. FeedbackForm.jsx
**Location:** `src/components/Feedback/FeedbackForm.jsx`

**Purpose:** Form component for creating/editing feedback

**Key Features:**
- Star rating selector (1-5 stars)
- Comment text area
- Form validation
- Loading state during submission
- Error handling
- Submit and cancel buttons

**Used By:**
- ProjectDetail.jsx (for creating feedback)
- Feedback edit flows

---

#### 17. Dashboard.jsx
**Location:** `src/components/Dashboard.jsx`

**Purpose:** Personal dashboard showing user's data

**Protection:** Auth Required ✅
- Redirects unauthenticated users to `/users/signin`
- Shows only logged-in user's data

**Key Features:**
- Display user's courses (owned)
- Display user's projects (owned)
- Display user's feedback (authored)
- Edit links to modify courses/projects
- Delete functionality for owned items
- Loading and error states
- Cache-busting headers for fresh data

**Auth Integration:**
- `useAuth()` hook for current user
- `authenticatedFetch()` for protected endpoint
- Data filtered by current user on backend

**API Calls:**
```javascript
// Protected endpoint
const dashboard = await authenticatedFetch(`${API_BASE_URL}/dashboard/me`);
const data = await dashboard.json();
```

**Route:** `/dashboard`

---

#### 18. Home.jsx
**Location:** `src/components/Home.jsx`

**Purpose:** Landing page

**Key Features:**
- Application overview
- Three feature cards (Courses, Users, Projects)
- Links to main sections
- Welcoming introduction
- Responsive design

**Route:** `/`

---

### Component Data Flow

```
App (with AuthProvider)
  ↓
MainRouter
  ↓
Layout (shows auth state in navbar)
  ↓
Routes
  ├── Home → Feature cards
  ├── Signin/Signup → AuthContext → localStorage
  ├── Dashboard → authenticatedFetch(/dashboard/me) → Display
  ├── ListCourse → coursesService.list() → Display
  ├── AddCourse → coursesService.create() → Redirect
  ├── EditCourse → coursesService.read/update() → Redirect
  ├── ListUser → usersService.list() → Display
  ├── EditUser → usersService.read/update() → Redirect
  ├── ListProject → projectsService.list() → Display
  ├── AddProject → projectsService.create() → Redirect
  ├── EditProject → projectsService.read/update() → Redirect
  ├── ProjectDetail → read project + feedbackService.list() → Display
  │                → feedbackService.create/update/remove() → Update
  └── ListItemUser → usersService.remove() → Reload
```

---

## Helpers & Utilities

### auth-helper.js

**Location:** `src/components/auth/auth-helper.js`

**Functions:**

#### Token Management
```javascript
setToken(token)
  → Stores JWT in localStorage
  → Key: 'token'

getToken()
  → Retrieves JWT from localStorage
  → Returns: string | null

removeToken()
  → Deletes token and user from localStorage
  → Called on logout
```

#### User Management
```javascript
setUser(user)
  → Stores user object in localStorage
  → Serializes to JSON
  → Key: 'user'

getUser()
  → Retrieves user object from localStorage
  → Parses JSON
  → Returns: object | null
```

#### Authentication Check
```javascript
isAuthenticated()
  → Checks if user has valid, non-expired token
  → Decodes JWT to check exp claim
  → Returns: boolean
```

#### Authentication Methods
```javascript
signup(uid, displayName, email, password, role)
  → POST /auth/signup
  → Stores token and user on success
  → Returns: { success: boolean, user?: object, message?: string }

signin(email, password)
  → POST /auth/signin
  → Stores token and user on success
  → Returns: { success: boolean, user?: object, message?: string }

logout()
  → Removes token and user from localStorage
  → Called on logout or token expiration
```

#### Authenticated Requests
```javascript
authenticatedFetch(url, options = {})
  → Wrapper around fetch()
  → Automatically adds Authorization header
  → Headers: { Authorization: Bearer <token> }
  → Handles 401 responses (token expired)
  → Auto-logout on 401 with redirect to /users/signin
  → Returns: Response object (standard fetch response)

// Example
const response = await authenticatedFetch('/courses', {
  method: 'POST',
  body: JSON.stringify(courseData)
});
```

---

## UI/UX Flows

### Sign Up Flow

```
User visits /users/signup
    ↓
Fills form (Full Name, Email, Role, Password, Confirm Password)
    ↓
Clicks "Sign Up"
    ↓
Frontend validates form
    ├── Full name required? ✓
    ├── Email required? ✓
    ├── Passwords match? ✓
    ├── Password ≥ 6 chars? ✓
    └── All valid → Proceed
    ↓
signup() called via AuthContext
    ↓
POST /auth/signup
    ├── Success → Store token & user → Redirect /
    └── Error → Display error message → Stay on page
    ↓
User logged in globally
    ↓
Can access protected routes
```

---

### Sign In Flow

```
User visits /users/signin (or redirected from protected route)
    ↓
Fills form (Email, Password)
    ↓
Clicks "Sign In"
    ↓
Frontend validates form
    ├── Email required? ✓
    ├── Password required? ✓
    └── Valid → Proceed
    ↓
signin() called via AuthContext
    ↓
POST /auth/signin
    ├── Success → Store token & user → Redirect
    │   ├── To previous page (if came from protected route)
    │   └── To / (default)
    └── Error → Display error message → Stay on page
    ↓
User logged in globally
    ↓
Can access protected routes
```

---

### Protected Route Flow

```
User tries to access /course/add (protected)
    ↓
Component checks useAuth()
    ├── isAuth === true? 
    │   └── Yes → Render component
    └── isAuth === false?
        ├── No → Show loading
        └── Redirect to /users/signin
            ├── state.from = /course/add
                └── After signin, redirect back to /course/add
```

---

### Create Course Flow

```
Authenticated user visits /course/add
    ↓
Fills form (Title, Description, Credits, Status, Instructor)
    ↓
Clicks "Save"
    ↓
Frontend validates form
    ↓
create(courseData) called
    ↓
POST /courses (with Authorization header)
    ├── Success (200)
    │   ├── Course created
    │   ├── Show success message
    │   └── Redirect to /course/list
    ├── Error 401 (Unauthorized)
    │   ├── Token invalid/expired
    │   ├── Auto-logout
    │   └── Redirect to /users/signin
    └── Error 400/500
        ├── Show error message
        └── Stay on page
```

---

### Token Expiration Flow

**Scenario 1: During App Load**
```
Page refreshed
    ↓
AuthProvider mounted
    ↓
Check localStorage for token
    ├── Token exists?
    │   ├── Yes → Decode JWT
    │   │   ├── Expired?
    │   │   │   ├── Yes → Remove token, set isAuth = false
    │   │   │   └── No → Load user, set isAuth = true
    │   └── No → Set isAuth = false
    └── Render components with correct auth state
```

**Scenario 2: During API Request**
```
Make authenticated request via authenticatedFetch()
    ↓
Response: 401 Unauthorized
    ├── Message: "Token has expired"
    ├── Call logout()
    ├── Remove token and user from localStorage
    ├── Set global isAuth = false
    └── Redirect to /users/signin
        └── User must sign in again
```

---

### Logout Flow

```
User clicks "Sign Out" in navbar dropdown
    ↓
logout() called via useAuth()
    ↓
Remove token from localStorage
    ↓
Remove user from localStorage
    ↓
Set global auth state: isAuth = false, user = null
    ↓
Redirect to /
    ↓
Layout component re-renders
    ├── Shows "Sign In/Sign Up" buttons
    └── Hides user profile dropdown
```

---

## Error Handling

### Backend Error Responses

All errors follow this format:

```json
{
  "success": false,
  "message": "Error description"
}
```

### HTTP Status Codes

| Code | Scenario | Frontend Behavior |
|------|----------|-------------------|
| 200 | Success | Process success response |
| 400 | Bad Request (missing fields) | Show error message |
| 401 | Unauthorized (invalid/expired token) | Auto-logout, redirect to signin |
| 403 | Forbidden (not owner) | Show "You don't have permission" error |
| 404 | Not Found | Show "Resource not found" error |
| 500 | Server Error | Show "Server error, please try again" |

### Frontend Error Handling

**Component-Level:**
```javascript
const [errorMsg, setErrorMsg] = useState('');

try {
  const result = await signup(...);
  if (result.success) {
    // Handle success
  } else {
    setErrorMsg(result.message); // Display error
  }
} catch (err) {
  setErrorMsg(err.message || 'An error occurred');
}
```

**Service-Level:**
```javascript
// Services use authenticatedFetch()
const response = await authenticatedFetch(url, options);
const data = await response.json();

// Check response status
if (!response.ok) {
  // Error response
  return data; // { success: false, message: "..." }
}

// Success response
return data;
```

**Network-Level:**
```javascript
// authenticatedFetch() handles 401 automatically
if (response.status === 401) {
  logout();
  redirect('/users/signin');
}
```

---

## Implementation Checklist

### ✅ Authentication
- [x] Signup form with validation
- [x] Signin form with validation
- [x] JWT token storage in localStorage
- [x] Token persistence across page refreshes
- [x] Logout functionality
- [x] Auto-logout on token expiration
- [x] Token attached to authenticated requests

### ✅ State Management
- [x] AuthContext created
- [x] AuthProvider wraps entire app
- [x] useAuth() hook implemented
- [x] Global auth state accessible throughout app
- [x] Auth state persists on refresh

### ✅ Components
- [x] Signin.jsx - Login form
- [x] Signup.jsx - Registration form
- [x] Layout.jsx - Navigation with auth display
- [x] ListCourse.jsx - Public course list
- [x] ListItemCourse.jsx - Course row with actions
- [x] AddCourse.jsx - Protected course creation
- [x] EditICourse.jsx - Protected course editing
- [x] ListUser.jsx - Public user list
- [x] ListItemUser.jsx - User row with actions
- [x] Home.jsx - Landing page

### ✅ Protected Routes
- [x] AddCourse (`/course/add`) - Auth required
- [x] EditCourse (`/course/edit/:id`) - Auth required
- [x] Auto-redirect to signin for unauthenticated users
- [x] Redirect back to requested route after signin

### ✅ API Integration
- [x] coursesService.js - Course CRUD operations
- [x] usersService.js - User operations
- [x] authenticatedFetch() - Automatic token attachment
- [x] Error handling (401, 403, 400, 500)
- [x] HTTP status code handling

### ✅ Helpers
- [x] auth-helper.js - Token and auth management
- [x] Token getter/setter functions
- [x] User getter/setter functions
- [x] isAuthenticated() check
- [x] signup() and signin() functions
- [x] logout() function
- [x] authenticatedFetch() wrapper

### ✅ UI/UX
- [x] Clean, consistent form styling
- [x] Labels above inputs (Material-UI style)
- [x] Required field indicators (red asterisks)
- [x] Error messages displayed clearly
- [x] Loading states on buttons during requests
- [x] Navigation menu reflects auth status
- [x] User profile dropdown with logout option
- [x] Responsive layout (mobile & desktop)

### ✅ Testing
- [x] Form validation tested
- [x] Token storage verified
- [x] Protected routes work correctly
- [x] Auth state persists on refresh
- [x] Logout clears token and user data
- [x] Error messages display properly

---

## Known Limitations

1. **Email Verification Not Implemented**
   - Users can signup with any email
   - No verification email sent
   - Future enhancement needed

2. **Password Reset Not Implemented**
   - No "Forgot Password" functionality
   - Users cannot reset forgotten passwords
   - Must contact admin or recreate account

3. **Role-Based UI Restrictions Missing**
   - Frontend doesn't restrict UI by role (student/instructor/admin)
   - Backend enforces role restrictions
   - All authenticated users see same UI options
   - Example: Admins can see course edit buttons even for non-owned courses

4. **Refresh Token Not Implemented**
   - Token expires after 7 days
   - No refresh token mechanism to extend session
   - Users must sign in again after expiration

5. **Two-Factor Authentication Not Supported**
   - No 2FA/MFA implementation
   - Authentication based solely on email + password

6. **Rate Limiting Not Enforced Frontend-Side**
   - No limit on signup/signin attempts
   - Backend should implement rate limiting
   - Frontend could add cooldown timers in future

7. **Sensitive Data in localStorage**
   - JWT token stored in localStorage (vulnerable to XSS)
   - User object stored in plain localStorage
   - Could be improved with httpOnly cookies + CSRF tokens

8. **No Offline Support**
   - App requires active internet connection
   - No service worker or offline caching
   - No syncing of offline changes

---

## Next Steps

### Phase 2: Enhanced Features
1. **Email Verification**
   - Send verification email on signup
   - Require email confirmation before account activation
   - Resend verification email functionality

2. **Password Reset Flow**
   - Implement "Forgot Password" page
   - Send reset token via email
   - Create password reset form

3. **Role-Based Access Control (RBAC)**
   - Hide admin-only features from non-admins
   - Restrict course editing to instructors + owners
   - Show role-specific UI elements

4. **Refresh Token Mechanism**
   - Implement refresh token endpoint
   - Auto-refresh token before expiration
   - Extend user session without re-login

5. **Better Security**
   - Switch from localStorage to httpOnly cookies
   - Implement CSRF protection
   - Add Content Security Policy (CSP) headers

6. **User Profile Management**
   - Create user edit profile page
   - Allow bio/profile picture updates
   - Display user public profile view

7. **Search & Filtering**
   - Add course search functionality
   - Filter courses by instructor, credits, status
   - Filter users by role

8. **Notifications**
   - Course update notifications
   - User activity notifications
   - Real-time updates via WebSocket

9. **Testing**
   - Unit tests for components (Vitest)
   - Integration tests for auth flow
   - E2E tests for user workflows (Cypress/Playwright)

10. **Performance Optimization**
    - Code splitting with React.lazy()
    - Image optimization
    - Bundle size reduction

---

## Development Commands

### Install Dependencies
```bash
npm install
```

### Start Development Server
```bash
npm start
# Opens at http://localhost:5173
```

### Build for Production
```bash
npm run build
# Creates dist/ folder for deployment
```

### Preview Production Build
```bash
npm run preview
```

### Run Tests
```bash
npm test
```

### Run Tests with UI
```bash
npm run test:ui
```

### Check Code Coverage
```bash
npm run test:coverage
```

### Lint Code
```bash
npm run lint
```

---

## Deployment

### Vercel (Current)

1. Push to GitHub
2. Connect repository to Vercel
3. Vercel auto-deploys on push to main
4. Set environment variables in Vercel dashboard:
   ```
   VITE_API_BASE_URL=https://your-render-url/api
   ```
5. Site live at: https://comp229-portfolio-frontend.vercel.app

### Manual Deployment

1. Build the project:
   ```bash
   npm run build
   ```

2. Upload `dist/` folder to hosting provider:
   - GitHub Pages
   - Netlify
   - AWS S3
   - Firebase Hosting
   - Any static hosting service

3. Configure API URL:
   - Update `.env.production` with backend URL
   - Rebuild before deploying

---

## File Structure

```
src/
├── components/
│   ├── auth/
│   │   ├── auth-helper.js          # Auth utilities and helpers
│   │   ├── AuthContext.jsx         # Global auth state
│   │   ├── Signin.jsx              # Login form
│   │   └── Signup.jsx              # Registration form
│   ├── Course/
│   │   ├── AddCourse.jsx           # Create course form
│   │   ├── CourseForm.jsx          # Reusable course form
│   │   ├── EditICourse.jsx         # Edit course form
│   │   ├── ListCourse.jsx          # Course list page
│   │   ├── ListCourse.test.jsx     # Course list tests
│   │   ├── ListItemCourse.jsx      # Course row component
│   │   └── ListItemCourse.test.jsx # Course row tests
│   ├── User/
│   │   ├── ListItemUser.jsx        # User row component
│   │   ├── ListItemUser.test.jsx   # User row tests
│   │   ├── ListUser.jsx            # User list page
│   │   └── ListUser.test.jsx       # User list tests
│   ├── Home.jsx                    # Landing page
│   ├── Layout.jsx                  # Navigation header
│   └── NotFound.jsx                # 404 page
├── services/
│   ├── api.js                      # API URL helper
│   ├── coursesService.js           # Course API calls
│   ├── usersService.js             # User API calls
│   └── apiHelper.js                # API utilities
├── datasource/
│   ├── CourseModel.js              # Course data model
│   └── userModel.js                # User data model
├── test/
│   ├── setup.js                    # Test configuration
│   └── test-utils.js               # Test utilities
├── App.jsx                         # Main app component
├── App.css                         # App styling
├── main.jsx                        # Entry point
├── index.css                       # Global styling
└── MainRouter.jsx                  # Route definitions
```

---

## API Error Response Examples

### Authentication Errors

**Signup - Email Already Exists**
```json
{
  "success": false,
  "message": "User with this uid or email already exists"
}
```

**Signin - Invalid Credentials**
```json
{
  "success": false,
  "message": "Invalid email or password"
}
```

### Authorization Errors

**Expired Token**
```json
{
  "success": false,
  "message": "Token has expired. Please sign in again."
}
```

**Invalid Token**
```json
{
  "success": false,
  "message": "Invalid token. Please authenticate."
}
```

**Not Owner (403 Forbidden)**
```json
{
  "success": false,
  "message": "You are not authorized to perform this action. Only the course owner can modify it."
}
```

### Validation Errors

**Missing Fields (400 Bad Request)**
```json
{
  "success": false,
  "message": "Missing required fields: title, email"
}
```

**Not Found (404)**
```json
{
  "success": false,
  "message": "Not Found"
}
```

---

## Glossary

| Term | Definition |
|------|-----------|
| **JWT** | JSON Web Token - stateless authentication token |
| **Token** | Short for JWT, used for authentication |
| **localStorage** | Browser storage that persists data indefinitely |
| **Context API** | React feature for global state management |
| **useAuth()** | Custom hook to access auth state and methods |
| **authenticatedFetch()** | Wrapper around fetch that adds auth header |
| **Ownership** | User is the creator/owner of a resource |
| **Role** | User type (student, instructor, admin) |
| **Protected Route** | Route that requires authentication |
| **Bearer Token** | Token format: "Bearer <token>" |
| **Expiration** | Token becomes invalid after this time |
| **XSS** | Cross-Site Scripting - security vulnerability |
| **CSRF** | Cross-Site Request Forgery - security vulnerability |

---

## Support & Troubleshooting

### Common Issues

**Issue: "Cannot find module 'auth-helper'"**
- Solution: Ensure path is correct in import statement
- Example: `import { useAuth } from '../auth/AuthContext';`

**Issue: Token not persisting after refresh**
- Check: Is `AuthProvider` wrapping the entire app?
- Check: Is localStorage enabled in browser?

**Issue: Stuck on login page after redirect**
- Check: Is backend API running at correct URL?
- Check: Is token expiration set correctly?
- Solution: Open DevTools → Application → localStorage → Check token exists

**Issue: "401 Unauthorized" on protected endpoint**
- Check: Is user actually logged in?
- Check: Is token expired?
- Solution: Check Network tab in DevTools to see actual request headers

**Issue: Cannot update/delete own course**
- Check: Did you create the course (are you the owner)?
- Check: Is course ID correct in URL?
- Solution: Backend validates ownership

---

## Contact & Support

For issues or questions:
1. Check this documentation
2. Review GitHub issues
3. Contact development team
4. Submit bug reports with:
   - Steps to reproduce
   - Expected behavior
   - Actual behavior
   - Browser/OS information
   - Network tab screenshot

---

**End of Documentation**

*For backend API documentation, see BACKEND_API_DOCUMENTATION.md*
